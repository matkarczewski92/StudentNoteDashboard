

           00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F

00000000   40 65 78 74 65 6E 64 73 28 27 6C 61 79 6F 75 74  @extends('layout
00000010   73 2E 61 70 70 27 29 0A 0A 40 73 65 63 74 69 6F  s.app')..@sectio
00000020   6E 28 27 63 6F 6E 74 65 6E 74 27 29 0A 3C 64 69  n('content').<di
00000030   76 20 63 6C 61 73 73 3D 22 63 6F 6E 74 61 69 6E  v class="contain
00000040   65 72 20 70 78 2D 33 20 70 78 2D 6D 64 2D 34 22  er px-3 px-md-4"
00000050   3E 0A 0A 20 20 3C 64 69 76 20 63 6C 61 73 73 3D  >..  <div class=
00000060   22 63 61 72 64 20 6D 62 2D 34 22 3E 0A 20 20 20  "card mb-4">.   
00000070   20 3C 64 69 76 20 63 6C 61 73 73 3D 22 63 61 72   <div class="car
00000080   64 2D 62 6F 64 79 20 64 2D 66 6C 65 78 20 6A 75  d-body d-flex ju
00000090   73 74 69 66 79 2D 63 6F 6E 74 65 6E 74 2D 62 65  stify-content-be
000000A0   74 77 65 65 6E 20 67 61 70 2D 33 22 3E 0A 20 20  tween gap-3">.  
000000B0   20 20 20 20 3C 64 69 76 20 63 6C 61 73 73 3D 22      <div class="
000000C0   66 6C 65 78 2D 67 72 6F 77 2D 31 22 3E 0A 20 20  flex-grow-1">.  
000000D0   20 20 20 20 20 20 3C 68 31 20 63 6C 61 73 73 3D        <h1 class=
000000E0   22 68 34 20 66 77 2D 62 6F 6C 64 20 6D 62 2D 32  "h4 fw-bold mb-2
000000F0   22 3E 7B 7B 20 24 70 6F 6C 6C 2D 3E 74 69 74 6C  ">{{ $poll->titl
00000100   65 20 7D 7D 3C 2F 68 31 3E 0A 20 20 20 20 20 20  e }}</h1>.      
00000110   20 20 3C 64 69 76 20 63 6C 61 73 73 3D 22 73 6D    <div class="sm
00000120   61 6C 6C 20 74 65 78 74 2D 62 6F 64 79 2D 73 65  all text-body-se
00000130   63 6F 6E 64 61 72 79 22 3E 41 75 74 6F 72 3A 20  condary">Autor: 
00000140   7B 7B 20 24 70 6F 6C 6C 2D 3E 75 73 65 72 2D 3E  {{ $poll->user->
00000150   6E 61 6D 65 20 3F 3F 20 27 3F 27 20 7D 7D 20 3F  name ?? '?' }} ?
00000160   3F 20 7B 7B 20 24 70 6F 6C 6C 2D 3E 63 72 65 61  ? {{ $poll->crea
00000170   74 65 64 5F 61 74 2D 3E 64 69 66 66 46 6F 72 48  ted_at->diffForH
00000180   75 6D 61 6E 73 28 29 20 7D 7D 3C 2F 64 69 76 3E  umans() }}</div>
00000190   0A 20 20 20 20 20 20 3C 2F 64 69 76 3E 0A 20 20  .      </div>.  
000001A0   20 20 20 20 3C 64 69 76 20 63 6C 61 73 73 3D 22      <div class="
000001B0   74 65 78 74 2D 65 6E 64 22 3E 0A 20 20 20 20 20  text-end">.     
000001C0   20 20 20 40 69 66 28 24 70 6F 6C 6C 2D 3E 69 73     @if($poll->is
000001D0   5F 63 6C 6F 73 65 64 29 0A 20 20 20 20 20 20 20  _closed).       
000001E0   20 20 20 3C 73 70 61 6E 20 63 6C 61 73 73 3D 22     <span class="
000001F0   62 61 64 67 65 20 74 65 78 74 2D 62 67 2D 64 61  badge text-bg-da
00000200   6E 67 65 72 22 3E 5A 61 6D 6B 6E 69 3F 3F 74 61  nger">Zamkni??ta
00000210   3C 2F 73 70 61 6E 3E 0A 20 20 20 20 20 20 20 20  </span>.        
00000220   40 65 6C 73 65 0A 20 20 20 20 20 20 20 20 20 20  @else.          
00000230   3C 73 70 61 6E 20 63 6C 61 73 73 3D 22 62 61 64  <span class="bad
00000240   67 65 20 74 65 78 74 2D 62 67 2D 73 75 63 63 65  ge text-bg-succe
00000250   73 73 22 3E 4F 74 77 61 72 74 65 3C 2F 73 70 61  ss">Otwarte</spa
00000260   6E 3E 0A 20 20 20 20 20 20 20 20 40 65 6E 64 69  n>.        @endi
00000270   66 0A 20 20 20 20 20 20 20 20 40 63 61 6E 28 27  f.        @can('
00000280   75 70 64 61 74 65 27 2C 20 24 70 6F 6C 6C 29 0A  update', $poll).
00000290   20 20 20 20 20 20 20 20 20 20 3C 66 6F 72 6D 20            <form 
000002A0   6D 65 74 68 6F 64 3D 22 70 6F 73 74 22 20 61 63  method="post" ac
000002B0   74 69 6F 6E 3D 22 7B 7B 20 72 6F 75 74 65 28 27  tion="{{ route('
000002C0   70 6F 6C 6C 73 2E 75 70 64 61 74 65 27 2C 20 24  polls.update', $
000002D0   70 6F 6C 6C 29 20 7D 7D 22 20 63 6C 61 73 73 3D  poll) }}" class=
000002E0   22 6D 74 2D 32 22 3E 0A 20 20 20 20 20 20 20 20  "mt-2">.        
000002F0   20 20 20 20 40 63 73 72 66 20 40 6D 65 74 68 6F      @csrf @metho
00000300   64 28 27 70 75 74 27 29 0A 20 20 20 20 20 20 20  d('put').       
00000310   20 20 20 20 20 3C 69 6E 70 75 74 20 74 79 70 65       <input type
00000320   3D 22 68 69 64 64 65 6E 22 20 6E 61 6D 65 3D 22  ="hidden" name="
00000330   69 73 5F 63 6C 6F 73 65 64 22 20 76 61 6C 75 65  is_closed" value
00000340   3D 22 7B 7B 20 24 70 6F 6C 6C 2D 3E 69 73 5F 63  ="{{ $poll->is_c
00000350   6C 6F 73 65 64 20 3F 20 30 20 3A 20 31 20 7D 7D  losed ? 0 : 1 }}
00000360   22 3E 0A 20 20 20 20 20 20 20 20 20 20 20 20 3C  ">.            <
00000370   62 75 74 74 6F 6E 20 63 6C 61 73 73 3D 22 62 74  button class="bt
00000380   6E 20 62 74 6E 2D 6F 75 74 6C 69 6E 65 2D 73 65  n btn-outline-se
00000390   63 6F 6E 64 61 72 79 20 62 74 6E 2D 73 6D 22 3E  condary btn-sm">
000003A0   7B 7B 20 24 70 6F 6C 6C 2D 3E 69 73 5F 63 6C 6F  {{ $poll->is_clo
000003B0   73 65 64 20 3F 20 27 4F 74 77 3F 3F 72 7A 27 20  sed ? 'Otw??rz' 
000003C0   3A 20 27 5A 61 6D 6B 6E 69 6A 27 20 7D 7D 3C 2F  : 'Zamknij' }}</
000003D0   62 75 74 74 6F 6E 3E 0A 20 20 20 20 20 20 20 20  button>.        
000003E0   20 20 3C 2F 66 6F 72 6D 3E 0A 20 20 20 20 20 20    </form>.      
000003F0   20 20 40 65 6E 64 63 61 6E 0A 20 20 20 20 20 20    @endcan.      
00000400   3C 2F 64 69 76 3E 0A 20 20 20 20 3C 2F 64 69 76  </div>.    </div
00000410   3E 0A 20 20 3C 2F 64 69 76 3E 0A 0A 20 20 3C 64  >.  </div>..  <d
00000420   69 76 20 63 6C 61 73 73 3D 22 72 6F 77 20 67 2D  iv class="row g-
00000430   33 22 3E 0A 20 20 20 20 3C 64 69 76 20 63 6C 61  3">.    <div cla
00000440   73 73 3D 22 63 6F 6C 2D 31 32 20 63 6F 6C 2D 6C  ss="col-12 col-l
00000450   67 2D 38 22 3E 0A 20 20 20 20 20 20 3C 64 69 76  g-8">.      <div
00000460   20 63 6C 61 73 73 3D 22 63 61 72 64 22 3E 0A 20   class="card">. 
00000470   20 20 20 20 20 20 20 3C 64 69 76 20 63 6C 61 73         <div clas
00000480   73 3D 22 63 61 72 64 2D 62 6F 64 79 22 3E 0A 20  s="card-body">. 
00000490   20 20 20 20 20 20 20 20 20 40 70 68 70 20 24 6D           @php $m
000004A0   75 6C 74 69 70 6C 65 20 3D 20 24 70 6F 6C 6C 2D  ultiple = $poll-
000004B0   3E 69 73 5F 6D 75 6C 74 69 70 6C 65 3B 20 40 65  >is_multiple; @e
000004C0   6E 64 70 68 70 0A 20 20 20 20 20 20 20 20 20 20  ndphp.          
000004D0   3C 66 6F 72 6D 20 69 64 3D 22 76 6F 74 65 2D 66  <form id="vote-f
000004E0   6F 72 6D 22 20 63 6C 61 73 73 3D 22 76 73 74 61  orm" class="vsta
000004F0   63 6B 20 67 61 70 2D 33 22 3E 0A 20 20 20 20 20  ck gap-3">.     
00000500   20 20 20 20 20 20 20 40 63 73 72 66 0A 20 20 20         @csrf.   
00000510   20 20 20 20 20 20 20 20 20 40 66 6F 72 65 61 63           @foreac
00000520   68 28 24 70 6F 6C 6C 2D 3E 6F 70 74 69 6F 6E 73  h($poll->options
00000530   20 61 73 20 24 6F 70 74 29 0A 20 20 20 20 20 20   as $opt).      
00000540   20 20 20 20 20 20 20 20 40 70 68 70 0A 20 20 20          @php.   
00000550   20 20 20 20 20 20 20 20 20 20 20 20 20 24 76 6F               $vo
00000560   74 65 73 20 3D 20 24 6F 70 74 2D 3E 76 6F 74 65  tes = $opt->vote
00000570   73 5F 63 6F 75 6E 74 20 3F 3F 20 24 6F 70 74 2D  s_count ?? $opt-
00000580   3E 76 6F 74 65 73 28 29 2D 3E 63 6F 75 6E 74 28  >votes()->count(
00000590   29 3B 0A 20 20 20 20 20 20 20 20 20 20 20 20 20  );.             
000005A0   20 40 65 6E 64 70 68 70 0A 20 20 20 20 20 20 20   @endphp.       
000005B0   20 20 20 20 20 20 20 3C 64 69 76 20 63 6C 61 73         <div clas
000005C0   73 3D 22 64 2D 66 6C 65 78 20 61 6C 69 67 6E 2D  s="d-flex align-
000005D0   69 74 65 6D 73 2D 63 65 6E 74 65 72 20 67 61 70  items-center gap
000005E0   2D 32 22 3E 0A 20 20 20 20 20 20 20 20 20 20 20  -2">.           
000005F0   20 20 20 20 20 3C 69 6E 70 75 74 0A 20 20 20 20       <input.    
00000600   20 20 20 20 20 20 20 20 20 20 20 20 20 20 74 79                ty
00000610   70 65 3D 22 7B 7B 20 24 6D 75 6C 74 69 70 6C 65  pe="{{ $multiple
00000620   20 3F 20 27 63 68 65 63 6B 62 6F 78 27 20 3A 20   ? 'checkbox' : 
00000630   27 72 61 64 69 6F 27 20 7D 7D 22 0A 20 20 20 20  'radio' }}".    
00000640   20 20 20 20 20 20 20 20 20 20 20 20 20 20 6E 61                na
00000650   6D 65 3D 22 7B 7B 20 24 6D 75 6C 74 69 70 6C 65  me="{{ $multiple
00000660   20 3F 20 27 6F 70 74 69 6F 6E 5F 69 64 73 5B 5D   ? 'option_ids[]
00000670   27 20 3A 20 27 6F 70 74 69 6F 6E 5F 69 64 27 20  ' : 'option_id' 
00000680   7D 7D 22 0A 20 20 20 20 20 20 20 20 20 20 20 20  }}".            
00000690   20 20 20 20 20 20 76 61 6C 75 65 3D 22 7B 7B 20        value="{{ 
000006A0   24 6F 70 74 2D 3E 69 64 20 7D 7D 22 0A 20 20 20  $opt->id }}".   
000006B0   20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 69                 i
000006C0   64 3D 22 6F 70 74 7B 7B 20 24 6F 70 74 2D 3E 69  d="opt{{ $opt->i
000006D0   64 20 7D 7D 22 0A 20 20 20 20 20 20 20 20 20 20  d }}".          
000006E0   20 20 20 20 20 20 20 20 40 63 68 65 63 6B 65 64          @checked
000006F0   28 69 6E 5F 61 72 72 61 79 28 24 6F 70 74 2D 3E  (in_array($opt->
00000700   69 64 2C 20 24 75 73 65 72 56 6F 74 65 49 64 73  id, $userVoteIds
00000710   29 29 0A 20 20 20 20 20 20 20 20 20 20 20 20 20  )).             
00000720   20 20 20 20 20 7B 7B 20 24 70 6F 6C 6C 2D 3E 69       {{ $poll->i
00000730   73 5F 63 6C 6F 73 65 64 20 3F 20 27 64 69 73 61  s_closed ? 'disa
00000740   62 6C 65 64 27 20 3A 20 27 27 20 7D 7D 0A 20 20  bled' : '' }}.  
00000750   20 20 20 20 20 20 20 20 20 20 20 20 20 20 3E 0A                >.
00000760   20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
00000770   3C 6C 61 62 65 6C 20 63 6C 61 73 73 3D 22 66 6F  <label class="fo
00000780   72 6D 2D 63 68 65 63 6B 2D 6C 61 62 65 6C 20 66  rm-check-label f
00000790   6C 65 78 2D 67 72 6F 77 2D 31 22 20 66 6F 72 3D  lex-grow-1" for=
000007A0   22 6F 70 74 7B 7B 20 24 6F 70 74 2D 3E 69 64 20  "opt{{ $opt->id 
000007B0   7D 7D 22 3E 7B 7B 20 24 6F 70 74 2D 3E 6C 61 62  }}">{{ $opt->lab
000007C0   65 6C 20 7D 7D 3C 2F 6C 61 62 65 6C 3E 0A 20 20  el }}</label>.  
000007D0   20 20 20 20 20 20 20 20 20 20 20 20 20 20 3C 73                <s
000007E0   70 61 6E 20 63 6C 61 73 73 3D 22 73 6D 61 6C 6C  pan class="small
000007F0   20 74 65 78 74 2D 62 6F 64 79 2D 73 65 63 6F 6E   text-body-secon
00000800   64 61 72 79 22 20 64 61 74 61 2D 76 6F 74 65 73  dary" data-votes
00000810   3D 22 7B 7B 20 24 6F 70 74 2D 3E 69 64 20 7D 7D  ="{{ $opt->id }}
00000820   22 3E 7B 7B 20 24 76 6F 74 65 73 20 7D 7D 3C 2F  ">{{ $votes }}</
00000830   73 70 61 6E 3E 0A 20 20 20 20 20 20 20 20 20 20  span>.          
00000840   20 20 20 20 3C 2F 64 69 76 3E 0A 20 20 20 20 20      </div>.     
00000850   20 20 20 20 20 20 20 20 20 3C 64 69 76 20 63 6C           <div cl
00000860   61 73 73 3D 22 70 72 6F 67 72 65 73 73 22 20 72  ass="progress" r
00000870   6F 6C 65 3D 22 70 72 6F 67 72 65 73 73 62 61 72  ole="progressbar
00000880   22 20 61 72 69 61 2D 76 61 6C 75 65 6E 6F 77 3D  " aria-valuenow=
00000890   22 30 22 20 61 72 69 61 2D 76 61 6C 75 65 6D 69  "0" aria-valuemi
000008A0   6E 3D 22 30 22 20 61 72 69 61 2D 76 61 6C 75 65  n="0" aria-value
000008B0   6D 61 78 3D 22 31 30 30 22 3E 0A 20 20 20 20 20  max="100">.     
000008C0   20 20 20 20 20 20 20 20 20 20 20 3C 64 69 76 20             <div 
000008D0   63 6C 61 73 73 3D 22 70 72 6F 67 72 65 73 73 2D  class="progress-
000008E0   62 61 72 22 20 73 74 79 6C 65 3D 22 77 69 64 74  bar" style="widt
000008F0   68 3A 20 30 25 22 20 64 61 74 61 2D 62 61 72 3D  h: 0%" data-bar=
00000900   22 7B 7B 20 24 6F 70 74 2D 3E 69 64 20 7D 7D 22  "{{ $opt->id }}"
00000910   3E 3C 2F 64 69 76 3E 0A 20 20 20 20 20 20 20 20  ></div>.        
00000920   20 20 20 20 20 20 3C 2F 64 69 76 3E 0A 20 20 20        </div>.   
00000930   20 20 20 20 20 20 20 20 20 40 65 6E 64 66 6F 72           @endfor
00000940   65 61 63 68 0A 20 20 20 20 20 20 20 20 20 20 20  each.           
00000950   20 3C 64 69 76 20 63 6C 61 73 73 3D 22 64 2D 66   <div class="d-f
00000960   6C 65 78 20 61 6C 69 67 6E 2D 69 74 65 6D 73 2D  lex align-items-
00000970   63 65 6E 74 65 72 20 6A 75 73 74 69 66 79 2D 63  center justify-c
00000980   6F 6E 74 65 6E 74 2D 62 65 74 77 65 65 6E 22 3E  ontent-between">
00000990   0A 20 20 20 20 20 20 20 20 20 20 20 20 20 20 3C  .              <
000009A0   64 69 76 20 63 6C 61 73 73 3D 22 73 6D 61 6C 6C  div class="small
000009B0   20 74 65 78 74 2D 62 6F 64 79 2D 73 65 63 6F 6E   text-body-secon
000009C0   64 61 72 79 22 3E 57 79 6E 69 6B 69 20 6E 61 20  dary">Wyniki na 
000009D0   3F 3F 79 77 6F 20 3F 3F 20 3C 73 70 61 6E 20 69  ??ywo ?? <span i
000009E0   64 3D 22 74 6F 74 61 6C 22 3E 30 3C 2F 73 70 61  d="total">0</spa
000009F0   6E 3E 20 67 3F 3F 6F 73 3F 3F 77 3C 2F 64 69 76  n> g??os??w</div
00000A00   3E 0A 20 20 20 20 20 20 20 20 20 20 20 20 20 20  >.              
00000A10   40 69 66 28 21 24 70 6F 6C 6C 2D 3E 69 73 5F 63  @if(!$poll->is_c
00000A20   6C 6F 73 65 64 29 0A 20 20 20 20 20 20 20 20 20  losed).         
00000A30   20 20 20 20 20 20 20 3C 62 75 74 74 6F 6E 20 69         <button i
00000A40   64 3D 22 76 6F 74 65 42 74 6E 22 20 74 79 70 65  d="voteBtn" type
00000A50   3D 22 62 75 74 74 6F 6E 22 20 63 6C 61 73 73 3D  ="button" class=
00000A60   22 62 74 6E 20 62 74 6E 2D 73 75 63 63 65 73 73  "btn btn-success
00000A70   20 62 74 6E 2D 73 6D 22 3E 47 3F 3F 6F 73 75 6A   btn-sm">G??osuj
00000A80   3C 2F 62 75 74 74 6F 6E 3E 0A 20 20 20 20 20 20  </button>.      
00000A90   20 20 20 20 20 20 20 20 40 65 6E 64 69 66 0A 20          @endif. 
00000AA0   20 20 20 20 20 20 20 20 20 20 20 3C 2F 64 69 76             </div
00000AB0   3E 0A 20 20 20 20 20 20 20 20 20 20 3C 2F 66 6F  >.          </fo
00000AC0   72 6D 3E 0A 20 20 20 20 20 20 20 20 3C 2F 64 69  rm>.        </di
00000AD0   76 3E 0A 20 20 20 20 20 20 3C 2F 64 69 76 3E 0A  v>.      </div>.
00000AE0   20 20 20 20 3C 2F 64 69 76 3E 0A 0A 20 20 20 20      </div>..    
00000AF0   3C 64 69 76 20 63 6C 61 73 73 3D 22 63 6F 6C 2D  <div class="col-
00000B00   31 32 20 63 6F 6C 2D 6C 67 2D 34 22 3E 0A 20 20  12 col-lg-4">.  
00000B10   20 20 20 20 40 63 61 6E 28 27 75 70 64 61 74 65      @can('update
00000B20   27 2C 20 24 70 6F 6C 6C 29 0A 20 20 20 20 20 20  ', $poll).      
00000B30   3C 64 69 76 20 63 6C 61 73 73 3D 22 63 61 72 64  <div class="card
00000B40   20 6D 62 2D 33 22 3E 0A 20 20 20 20 20 20 20 20   mb-3">.        
00000B50   3C 64 69 76 20 63 6C 61 73 73 3D 22 63 61 72 64  <div class="card
00000B60   2D 62 6F 64 79 22 3E 0A 20 20 20 20 20 20 20 20  -body">.        
00000B70   20 20 3C 64 69 76 20 63 6C 61 73 73 3D 22 66 6F    <div class="fo
00000B80   72 6D 2D 63 68 65 63 6B 20 66 6F 72 6D 2D 73 77  rm-check form-sw
00000B90   69 74 63 68 20 6D 62 2D 32 22 3E 0A 20 20 20 20  itch mb-2">.    
00000BA0   20 20 20 20 20 20 20 20 3C 69 6E 70 75 74 20 63          <input c
00000BB0   6C 61 73 73 3D 22 66 6F 72 6D 2D 63 68 65 63 6B  lass="form-check
00000BC0   2D 69 6E 70 75 74 22 20 74 79 70 65 3D 22 63 68  -input" type="ch
00000BD0   65 63 6B 62 6F 78 22 20 72 6F 6C 65 3D 22 73 77  eckbox" role="sw
00000BE0   69 74 63 68 22 20 69 64 3D 22 6D 75 6C 74 69 70  itch" id="multip
00000BF0   6C 65 53 77 69 74 63 68 22 20 7B 7B 20 24 70 6F  leSwitch" {{ $po
00000C00   6C 6C 2D 3E 69 73 5F 6D 75 6C 74 69 70 6C 65 20  ll->is_multiple 
00000C10   3F 20 27 63 68 65 63 6B 65 64 27 20 3A 20 27 27  ? 'checked' : ''
00000C20   20 7D 7D 20 64 61 74 61 2D 75 72 6C 3D 22 7B 7B   }} data-url="{{
00000C30   20 72 6F 75 74 65 28 27 70 6F 6C 6C 73 2E 75 70   route('polls.up
00000C40   64 61 74 65 27 2C 20 24 70 6F 6C 6C 29 20 7D 7D  date', $poll) }}
00000C50   22 3E 0A 20 20 20 20 20 20 20 20 20 20 20 20 3C  ">.            <
00000C60   6C 61 62 65 6C 20 63 6C 61 73 73 3D 22 66 6F 72  label class="for
00000C70   6D 2D 63 68 65 63 6B 2D 6C 61 62 65 6C 22 20 66  m-check-label" f
00000C80   6F 72 3D 22 6D 75 6C 74 69 70 6C 65 53 77 69 74  or="multipleSwit
00000C90   63 68 22 3E 5A 65 7A 77 3F 3F 6C 20 6E 61 20 77  ch">Zezw??l na w
00000CA0   69 65 6C 6F 6B 72 6F 74 6E 79 20 77 79 62 3F 3F  ielokrotny wyb??
00000CB0   72 3C 2F 6C 61 62 65 6C 3E 0A 20 20 20 20 20 20  r</label>.      
00000CC0   20 20 20 20 3C 2F 64 69 76 3E 0A 20 20 20 20 20      </div>.     
00000CD0   20 20 20 20 20 3C 66 6F 72 6D 20 6D 65 74 68 6F       <form metho
00000CE0   64 3D 22 70 6F 73 74 22 20 61 63 74 69 6F 6E 3D  d="post" action=
00000CF0   22 7B 7B 20 72 6F 75 74 65 28 27 70 6F 6C 6C 5F  "{{ route('poll_
00000D00   6F 70 74 69 6F 6E 73 2E 73 74 6F 72 65 27 2C 20  options.store', 
00000D10   24 70 6F 6C 6C 29 20 7D 7D 22 20 63 6C 61 73 73  $poll) }}" class
00000D20   3D 22 64 2D 66 6C 65 78 20 67 61 70 2D 32 22 3E  ="d-flex gap-2">
00000D30   0A 20 20 20 20 20 20 20 20 20 20 20 20 40 63 73  .            @cs
00000D40   72 66 0A 20 20 20 20 20 20 20 20 20 20 20 20 3C  rf.            <
00000D50   69 6E 70 75 74 20 6E 61 6D 65 3D 22 6C 61 62 65  input name="labe
00000D60   6C 22 20 63 6C 61 73 73 3D 22 66 6F 72 6D 2D 63  l" class="form-c
00000D70   6F 6E 74 72 6F 6C 22 20 70 6C 61 63 65 68 6F 6C  ontrol" placehol
00000D80   64 65 72 3D 22 44 6F 64 61 6A 20 6F 70 63 6A 3F  der="Dodaj opcj?
00000D90   3F 22 3E 0A 20 20 20 20 20 20 20 20 20 20 20 20  ?">.            
00000DA0   3C 62 75 74 74 6F 6E 20 63 6C 61 73 73 3D 22 62  <button class="b
00000DB0   74 6E 20 62 74 6E 2D 6F 75 74 6C 69 6E 65 2D 73  tn btn-outline-s
00000DC0   65 63 6F 6E 64 61 72 79 22 3E 44 6F 64 61 6A 3C  econdary">Dodaj<
00000DD0   2F 62 75 74 74 6F 6E 3E 0A 20 20 20 20 20 20 20  /button>.       
00000DE0   20 20 20 3C 2F 66 6F 72 6D 3E 0A 20 20 20 20 20     </form>.     
00000DF0   20 20 20 3C 2F 64 69 76 3E 0A 20 20 20 20 20 20     </div>.      
00000E00   3C 2F 64 69 76 3E 0A 20 20 20 20 20 20 40 65 6E  </div>.      @en
00000E10   64 63 61 6E 0A 0A 20 20 20 20 20 20 3C 64 69 76  dcan..      <div
00000E20   20 63 6C 61 73 73 3D 22 63 61 72 64 22 3E 0A 20   class="card">. 
00000E30   20 20 20 20 20 20 20 3C 64 69 76 20 63 6C 61 73         <div clas
00000E40   73 3D 22 63 61 72 64 2D 62 6F 64 79 22 3E 0A 20  s="card-body">. 
00000E50   20 20 20 20 20 20 20 20 20 3C 61 20 68 72 65 66           <a href
00000E60   3D 22 7B 7B 20 72 6F 75 74 65 28 27 70 6F 6C 6C  ="{{ route('poll
00000E70   73 2E 69 6E 64 65 78 27 29 20 7D 7D 22 20 63 6C  s.index') }}" cl
00000E80   61 73 73 3D 22 62 74 6E 20 62 74 6E 2D 6F 75 74  ass="btn btn-out
00000E90   6C 69 6E 65 2D 73 65 63 6F 6E 64 61 72 79 20 62  line-secondary b
00000EA0   74 6E 2D 73 6D 22 3E 57 72 3F 3F 3F 3F 20 64 6F  tn-sm">Wr???? do
00000EB0   20 6C 69 73 74 79 3C 2F 61 3E 0A 20 20 20 20 20   listy</a>.     
00000EC0   20 20 20 3C 2F 64 69 76 3E 0A 20 20 20 20 20 20     </div>.      
00000ED0   3C 2F 64 69 76 3E 0A 20 20 20 20 3C 2F 64 69 76  </div>.    </div
00000EE0   3E 0A 20 20 3C 2F 64 69 76 3E 0A 0A 3C 2F 64 69  >.  </div>..</di
00000EF0   76 3E 0A 0A 40 70 75 73 68 28 27 73 63 72 69 70  v>..@push('scrip
00000F00   74 73 27 29 0A 3C 73 63 72 69 70 74 3E 0A 20 20  ts').<script>.  
00000F10   63 6F 6E 73 74 20 50 4F 4C 4C 5F 49 44 20 3D 20  const POLL_ID = 
00000F20   7B 7B 20 24 70 6F 6C 6C 2D 3E 69 64 20 7D 7D 3B  {{ $poll->id }};
00000F30   0A 20 20 63 6F 6E 73 74 20 53 54 41 54 53 5F 55  .  const STATS_U
00000F40   52 4C 20 3D 20 40 6A 73 6F 6E 28 72 6F 75 74 65  RL = @json(route
00000F50   28 27 70 6F 6C 6C 73 2E 73 74 61 74 73 27 2C 20  ('polls.stats', 
00000F60   24 70 6F 6C 6C 29 29 3B 0A 20 20 63 6F 6E 73 74  $poll));.  const
00000F70   20 56 4F 54 45 5F 55 52 4C 20 3D 20 40 6A 73 6F   VOTE_URL = @jso
00000F80   6E 28 72 6F 75 74 65 28 27 70 6F 6C 6C 73 2E 76  n(route('polls.v
00000F90   6F 74 65 27 2C 20 24 70 6F 6C 6C 29 29 3B 0A 20  ote', $poll));. 
00000FA0   20 63 6F 6E 73 74 20 4D 55 4C 54 49 50 4C 45 20   const MULTIPLE 
00000FB0   3D 20 7B 7B 20 24 70 6F 6C 6C 2D 3E 69 73 5F 6D  = {{ $poll->is_m
00000FC0   75 6C 74 69 70 6C 65 20 3F 20 27 74 72 75 65 27  ultiple ? 'true'
00000FD0   20 3A 20 27 66 61 6C 73 65 27 20 7D 7D 3B 0A 0A   : 'false' }};..
00000FE0   20 20 61 73 79 6E 63 20 66 75 6E 63 74 69 6F 6E    async function
00000FF0   20 72 65 66 72 65 73 68 53 74 61 74 73 28 29 7B   refreshStats(){
00001000   0A 20 20 20 20 74 72 79 20 7B 0A 20 20 20 20 20  .    try {.     
00001010   20 63 6F 6E 73 74 20 72 65 73 20 3D 20 61 77 61   const res = awa
00001020   69 74 20 66 65 74 63 68 28 53 54 41 54 53 5F 55  it fetch(STATS_U
00001030   52 4C 2C 20 7B 20 68 65 61 64 65 72 73 3A 20 7B  RL, { headers: {
00001040   20 27 41 63 63 65 70 74 27 3A 20 27 61 70 70 6C   'Accept': 'appl
00001050   69 63 61 74 69 6F 6E 2F 6A 73 6F 6E 27 20 7D 20  ication/json' } 
00001060   7D 29 3B 0A 20 20 20 20 20 20 69 66 20 28 21 72  });.      if (!r
00001070   65 73 2E 6F 6B 29 20 72 65 74 75 72 6E 3B 0A 20  es.ok) return;. 
00001080   20 20 20 20 20 63 6F 6E 73 74 20 64 61 74 61 20       const data 
00001090   3D 20 61 77 61 69 74 20 72 65 73 2E 6A 73 6F 6E  = await res.json
000010A0   28 29 3B 0A 20 20 20 20 20 20 64 6F 63 75 6D 65  ();.      docume
000010B0   6E 74 2E 67 65 74 45 6C 65 6D 65 6E 74 42 79 49  nt.getElementByI
000010C0   64 28 27 74 6F 74 61 6C 27 29 2E 74 65 78 74 43  d('total').textC
000010D0   6F 6E 74 65 6E 74 20 3D 20 64 61 74 61 2E 74 6F  ontent = data.to
000010E0   74 61 6C 20 3F 3F 20 30 3B 0A 20 20 20 20 20 20  tal ?? 0;.      
000010F0   66 6F 72 20 28 63 6F 6E 73 74 20 6F 20 6F 66 20  for (const o of 
00001100   64 61 74 61 2E 6F 70 74 69 6F 6E 73 20 7C 7C 20  data.options || 
00001110   5B 5D 29 20 7B 0A 20 20 20 20 20 20 20 20 63 6F  []) {.        co
00001120   6E 73 74 20 62 61 72 20 3D 20 64 6F 63 75 6D 65  nst bar = docume
00001130   6E 74 2E 71 75 65 72 79 53 65 6C 65 63 74 6F 72  nt.querySelector
00001140   28 60 5B 64 61 74 61 2D 62 61 72 3D 22 24 7B 6F  (`[data-bar="${o
00001150   2E 69 64 7D 22 5D 60 29 3B 0A 20 20 20 20 20 20  .id}"]`);.      
00001160   20 20 63 6F 6E 73 74 20 76 63 20 3D 20 64 6F 63    const vc = doc
00001170   75 6D 65 6E 74 2E 71 75 65 72 79 53 65 6C 65 63  ument.querySelec
00001180   74 6F 72 28 60 5B 64 61 74 61 2D 76 6F 74 65 73  tor(`[data-votes
00001190   3D 22 24 7B 6F 2E 69 64 7D 22 5D 60 29 3B 0A 20  ="${o.id}"]`);. 
000011A0   20 20 20 20 20 20 20 69 66 20 28 62 61 72 29 20         if (bar) 
000011B0   7B 20 62 61 72 2E 73 74 79 6C 65 2E 77 69 64 74  { bar.style.widt
000011C0   68 20 3D 20 28 6F 2E 70 65 72 63 65 6E 74 7C 7C  h = (o.percent||
000011D0   30 29 20 2B 20 27 25 27 3B 20 62 61 72 2E 74 65  0) + '%'; bar.te
000011E0   78 74 43 6F 6E 74 65 6E 74 20 3D 20 28 6F 2E 70  xtContent = (o.p
000011F0   65 72 63 65 6E 74 7C 7C 30 29 20 2B 20 27 25 27  ercent||0) + '%'
00001200   3B 20 7D 0A 20 20 20 20 20 20 20 20 69 66 20 28  ; }.        if (
00001210   76 63 29 20 7B 20 76 63 2E 74 65 78 74 43 6F 6E  vc) { vc.textCon
00001220   74 65 6E 74 20 3D 20 6F 2E 76 6F 74 65 73 20 3F  tent = o.votes ?
00001230   3F 20 30 3B 20 7D 0A 20 20 20 20 20 20 7D 0A 20  ? 0; }.      }. 
00001240   20 20 20 7D 20 63 61 74 63 68 20 28 65 29 20 7B     } catch (e) {
00001250   20 63 6F 6E 73 6F 6C 65 2E 65 72 72 6F 72 28 65   console.error(e
00001260   29 3B 20 7D 0A 20 20 7D 0A 0A 20 20 73 65 74 49  ); }.  }..  setI
00001270   6E 74 65 72 76 61 6C 28 72 65 66 72 65 73 68 53  nterval(refreshS
00001280   74 61 74 73 2C 20 33 30 30 30 29 3B 0A 20 20 72  tats, 3000);.  r
00001290   65 66 72 65 73 68 53 74 61 74 73 28 29 3B 0A 0A  efreshStats();..
000012A0   20 20 64 6F 63 75 6D 65 6E 74 2E 67 65 74 45 6C    document.getEl
000012B0   65 6D 65 6E 74 42 79 49 64 28 27 76 6F 74 65 42  ementById('voteB
000012C0   74 6E 27 29 3F 2E 61 64 64 45 76 65 6E 74 4C 69  tn')?.addEventLi
000012D0   73 74 65 6E 65 72 28 27 63 6C 69 63 6B 27 2C 20  stener('click', 
000012E0   61 73 79 6E 63 20 28 29 20 3D 3E 20 7B 0A 20 20  async () => {.  
000012F0   20 20 74 72 79 20 7B 0A 20 20 20 20 20 20 63 6F    try {.      co
00001300   6E 73 74 20 66 64 20 3D 20 6E 65 77 20 46 6F 72  nst fd = new For
00001310   6D 44 61 74 61 28 29 3B 0A 20 20 20 20 20 20 69  mData();.      i
00001320   66 20 28 4D 55 4C 54 49 50 4C 45 29 20 7B 0A 20  f (MULTIPLE) {. 
00001330   20 20 20 20 20 20 20 64 6F 63 75 6D 65 6E 74 2E         document.
00001340   71 75 65 72 79 53 65 6C 65 63 74 6F 72 41 6C 6C  querySelectorAll
00001350   28 27 69 6E 70 75 74 5B 6E 61 6D 65 3D 22 6F 70  ('input[name="op
00001360   74 69 6F 6E 5F 69 64 73 5B 5D 22 5D 3A 63 68 65  tion_ids[]"]:che
00001370   63 6B 65 64 27 29 2E 66 6F 72 45 61 63 68 28 69  cked').forEach(i
00001380   20 3D 3E 20 66 64 2E 61 70 70 65 6E 64 28 27 6F   => fd.append('o
00001390   70 74 69 6F 6E 5F 69 64 73 5B 5D 27 2C 20 69 2E  ption_ids[]', i.
000013A0   76 61 6C 75 65 29 29 3B 0A 20 20 20 20 20 20 7D  value));.      }
000013B0   20 65 6C 73 65 20 7B 0A 20 20 20 20 20 20 20 20   else {.        
000013C0   63 6F 6E 73 74 20 73 65 6C 20 3D 20 64 6F 63 75  const sel = docu
000013D0   6D 65 6E 74 2E 71 75 65 72 79 53 65 6C 65 63 74  ment.querySelect
000013E0   6F 72 28 27 69 6E 70 75 74 5B 6E 61 6D 65 3D 22  or('input[name="
000013F0   6F 70 74 69 6F 6E 5F 69 64 22 5D 3A 63 68 65 63  option_id"]:chec
00001400   6B 65 64 27 29 3B 0A 20 20 20 20 20 20 20 20 69  ked');.        i
00001410   66 20 28 73 65 6C 29 20 66 64 2E 61 70 70 65 6E  f (sel) fd.appen
00001420   64 28 27 6F 70 74 69 6F 6E 5F 69 64 27 2C 20 73  d('option_id', s
00001430   65 6C 2E 76 61 6C 75 65 29 3B 0A 20 20 20 20 20  el.value);.     
00001440   20 7D 0A 20 20 20 20 20 20 63 6F 6E 73 74 20 72   }.      const r
00001450   65 73 20 3D 20 61 77 61 69 74 20 66 65 74 63 68  es = await fetch
00001460   28 56 4F 54 45 5F 55 52 4C 2C 20 7B 20 6D 65 74  (VOTE_URL, { met
00001470   68 6F 64 3A 20 27 50 4F 53 54 27 2C 20 68 65 61  hod: 'POST', hea
00001480   64 65 72 73 3A 20 7B 20 27 58 2D 43 53 52 46 2D  ders: { 'X-CSRF-
00001490   54 4F 4B 45 4E 27 3A 20 64 6F 63 75 6D 65 6E 74  TOKEN': document
000014A0   2E 71 75 65 72 79 53 65 6C 65 63 74 6F 72 28 27  .querySelector('
000014B0   69 6E 70 75 74 5B 6E 61 6D 65 3D 5F 74 6F 6B 65  input[name=_toke
000014C0   6E 5D 27 29 2E 76 61 6C 75 65 20 7D 2C 20 62 6F  n]').value }, bo
000014D0   64 79 3A 20 66 64 20 7D 29 3B 0A 20 20 20 20 20  dy: fd });.     
000014E0   20 69 66 20 28 72 65 73 2E 73 74 61 74 75 73 20   if (res.status 
000014F0   3D 3D 3D 20 34 30 31 29 20 7B 20 77 69 6E 64 6F  === 401) { windo
00001500   77 2E 6C 6F 63 61 74 69 6F 6E 20 3D 20 40 6A 73  w.location = @js
00001510   6F 6E 28 72 6F 75 74 65 28 27 6C 6F 67 69 6E 27  on(route('login'
00001520   29 29 3B 20 72 65 74 75 72 6E 3B 20 7D 0A 20 20  )); return; }.  
00001530   20 20 20 20 69 66 20 28 21 72 65 73 2E 6F 6B 29      if (!res.ok)
00001540   20 7B 20 63 6F 6E 73 6F 6C 65 2E 65 72 72 6F 72   { console.error
00001550   28 27 76 6F 74 65 20 66 61 69 6C 65 64 27 2C 20  ('vote failed', 
00001560   72 65 73 2E 73 74 61 74 75 73 29 3B 20 72 65 74  res.status); ret
00001570   75 72 6E 3B 20 7D 0A 20 20 20 20 20 20 61 77 61  urn; }.      awa
00001580   69 74 20 72 65 66 72 65 73 68 53 74 61 74 73 28  it refreshStats(
00001590   29 3B 0A 20 20 20 20 7D 20 63 61 74 63 68 20 28  );.    } catch (
000015A0   65 29 20 7B 20 63 6F 6E 73 6F 6C 65 2E 65 72 72  e) { console.err
000015B0   6F 72 28 65 29 3B 20 7D 0A 20 20 7D 29 3B 0A 0A  or(e); }.  });..
000015C0   20 20 2F 2F 20 74 6F 67 67 6C 65 20 6D 75 6C 74    // toggle mult
000015D0   69 70 6C 65 0A 20 20 64 6F 63 75 6D 65 6E 74 2E  iple.  document.
000015E0   67 65 74 45 6C 65 6D 65 6E 74 42 79 49 64 28 27  getElementById('
000015F0   6D 75 6C 74 69 70 6C 65 53 77 69 74 63 68 27 29  multipleSwitch')
00001600   3F 2E 61 64 64 45 76 65 6E 74 4C 69 73 74 65 6E  ?.addEventListen
00001610   65 72 28 27 63 68 61 6E 67 65 27 2C 20 61 73 79  er('change', asy
00001620   6E 63 20 28 65 29 20 3D 3E 20 7B 0A 20 20 20 20  nc (e) => {.    
00001630   63 6F 6E 73 74 20 75 72 6C 20 3D 20 65 2E 74 61  const url = e.ta
00001640   72 67 65 74 2E 64 61 74 61 73 65 74 2E 75 72 6C  rget.dataset.url
00001650   3B 0A 20 20 20 20 63 6F 6E 73 74 20 66 64 20 3D  ;.    const fd =
00001660   20 6E 65 77 20 46 6F 72 6D 44 61 74 61 28 29 3B   new FormData();
00001670   0A 20 20 20 20 66 64 2E 61 70 70 65 6E 64 28 27  .    fd.append('
00001680   5F 6D 65 74 68 6F 64 27 2C 27 50 55 54 27 29 3B  _method','PUT');
00001690   0A 20 20 20 20 66 64 2E 61 70 70 65 6E 64 28 27  .    fd.append('
000016A0   69 73 5F 6D 75 6C 74 69 70 6C 65 27 2C 20 65 2E  is_multiple', e.
000016B0   74 61 72 67 65 74 2E 63 68 65 63 6B 65 64 20 3F  target.checked ?
000016C0   20 27 31 27 20 3A 20 27 30 27 29 3B 0A 20 20 20   '1' : '0');.   
000016D0   20 61 77 61 69 74 20 66 65 74 63 68 28 75 72 6C   await fetch(url
000016E0   2C 20 7B 20 6D 65 74 68 6F 64 3A 20 27 50 4F 53  , { method: 'POS
000016F0   54 27 2C 20 68 65 61 64 65 72 73 3A 20 7B 20 27  T', headers: { '
00001700   58 2D 43 53 52 46 2D 54 4F 4B 45 4E 27 3A 20 64  X-CSRF-TOKEN': d
00001710   6F 63 75 6D 65 6E 74 2E 71 75 65 72 79 53 65 6C  ocument.querySel
00001720   65 63 74 6F 72 28 27 69 6E 70 75 74 5B 6E 61 6D  ector('input[nam
00001730   65 3D 5F 74 6F 6B 65 6E 5D 27 29 2E 76 61 6C 75  e=_token]').valu
00001740   65 20 7D 2C 20 62 6F 64 79 3A 20 66 64 20 7D 29  e }, body: fd })
00001750   3B 0A 20 20 7D 29 3B 0A 3C 2F 73 63 72 69 70 74  ;.  });.</script
00001760   3E 0A 40 65 6E 64 70 75 73 68 0A 40 65 6E 64 73  >.@endpush.@ends
00001770   65 63 74 69 6F 6E 0A 0A 0D 0A 0D 0A              ection......    



